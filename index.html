<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bank of America • Internal Wire Tracker (Fixed)</title>
<style>
  :root{--bofa-red:#d4001a;--bofa-blue:#0033a0;--bg:#f3f4f6;--muted:#6b7280;--card:#fff;--max-width:920px}
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;font-family:Inter,system-ui,Arial;background:linear-gradient(180deg,var(--bg),#fafafa);color:#0f172a;display:flex;flex-direction:column;align-items:center}
  header{width:100%;background:var(--bofa-blue);color:#fff;padding:14px 16px;box-shadow:0 8px 30px rgba(2,6,23,0.12)}
  .header-inner{max-width:var(--max-width);margin:0 auto;display:flex;align-items:center;justify-content:space-between;gap:12px}
  .brand{display:flex;align-items:center;gap:12px}
  .brand img{width:46px;height:46px;border-radius:8px;object-fit:cover}
  .brand h1{margin:0;font-size:1rem;font-weight:800}
  main{width:100%;max-width:var(--max-width);padding:28px 16px 48px;margin:0 auto;flex:1;display:flex;flex-direction:column;gap:18px;align-items:stretch}
  .card{background:var(--card);border-radius:12px;padding:20px;display:flex;gap:12px;align-items:center;justify-content:space-between;box-shadow:0 14px 36px rgba(2,6,23,0.06)}
  .card .left{display:flex;flex-direction:column;gap:6px}
  .card h2{margin:0;font-size:1.05rem;font-weight:900}
  .card p{margin:0;color:var(--muted);font-size:0.95rem}
  .primary-btn{background:var(--bofa-red);color:white;border:none;padding:12px 18px;border-radius:10px;font-weight:800;cursor:pointer;box-shadow:0 10px 22px rgba(212,0,26,0.14)}
  .overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999;background:rgba(7,10,23,0.28);transition:opacity .22s ease}
  .overlay.visible{display:flex;opacity:1}
  .loader-box{background:rgba(255,255,255,0.98);padding:18px;border-radius:12px;display:flex;gap:14px;align-items:center;box-shadow:0 8px 24px rgba(2,6,23,0.12)}
  .spinner{width:46px;height:46px;border-radius:50%;border:5px solid #eef2f7;border-top-color:var(--bofa-blue);animation:spin .9s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}
  .receipt-wrap{display:flex;justify-content:center;width:100%}
  .receipt{width:100%;max-width:820px;background:var(--card);border-radius:12px;padding:22px;box-shadow:0 20px 48px rgba(2,6,23,0.08);position:relative;overflow:hidden;display:flex;flex-direction:column;gap:16px}
  .receipt::after{content:"";position:absolute;inset:0;background-image:url('https://i.imgur.com/q4HmdZ6.png');background-repeat:no-repeat;background-position:center right;background-size:420px auto;opacity:0.06;transform:rotate(-6deg) translate(20px,-8px);pointer-events:none;filter:grayscale(1)}
  .receipt-top{display:flex;align-items:center;justify-content:space-between;gap:14px}
  .receipt-left{display:flex;gap:12px;align-items:center}
  .logo{width:72px;height:72px;border-radius:8px;overflow:hidden;flex:0 0 72px}
  .logo img{width:100%;height:100%;object-fit:cover}
  .receipt-info{display:flex;flex-direction:column;gap:3px}
  .receipt-info .org{font-weight:900;font-size:1.02rem}
  .receipt-info .sub{color:var(--muted);font-size:0.92rem}
  .amount-box{text-align:right;min-width:180px}
  .small-label{font-size:0.9rem;color:var(--muted);font-weight:700}
  .amount{text-align:right;font-weight:900;color:var(--bofa-red);font-size:2.4rem;margin-top:6px}
  .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;align-items:stretch}
  .field{background:linear-gradient(180deg,#fff,#fbfbfd);border-radius:10px;padding:12px;border:1px solid rgba(2,6,23,0.04);display:flex;flex-direction:column;justify-content:center}
  .label{font-size:0.82rem;color:var(--muted);font-weight:700}
  .value{font-weight:900;color:#111;text-transform:uppercase;font-size:1rem}
  .meta-row{display:flex;justify-content:space-between;gap:8px;align-items:center;margin-top:6px}
  .notice{color:var(--muted);font-size:0.95rem}
  .actions{display:flex;justify-content:center;margin-top:10px}
  .big-red{background:var(--bofa-red);color:white;border:none;padding:14px 22px;border-radius:10px;font-weight:900;cursor:pointer}
  .code-wrap{width:100%;max-width:520px;margin:10px auto;background:var(--card);padding:20px;border-radius:12px;box-shadow:0 20px 40px rgba(2,6,23,0.06);display:flex;flex-direction:column;gap:12px;align-items:center}
  .code-header{display:flex;align-items:center;gap:12px}
  .small-logo{width:48px;height:48px;border-radius:8px;overflow:hidden}
  .small-logo img{width:100%;height:100%;object-fit:cover}
  .warning{background:linear-gradient(90deg,#fff4f4,#fff1f1);border:1px solid rgba(212,0,26,0.06);color:var(--bofa-red);padding:12px;border-radius:8px;font-weight:800;text-align:center}
  .timer{font-weight:900;color:var(--bofa-red);font-size:1.05rem;margin-top:4px}
  .code-inputs{display:flex;gap:10px;justify-content:center;margin-top:6px}
  .code-inputs input{width:56px;height:62px;font-size:1.6rem;font-weight:800;text-align:center;border-radius:8px;border:2px solid rgba(2,6,23,0.06)}
  .submit-code{background:var(--bofa-red);color:white;padding:10px 14px;border-radius:8px;border:none;font-weight:800;cursor:pointer}
  .meta-text{margin-top:10px;font-size:0.95rem;color:var(--muted)}
  .meta-link{color:var(--bofa-blue);text-decoration:none;font-weight:800;cursor:pointer}
  .hidden{display:none !important}
  .debug-badge{position:fixed;right:14px;bottom:14px;background:#111;color:#fff;padding:8px 10px;border-radius:8px;font-size:12px;z-index:99999;opacity:0.9}
  footer{padding:18px 12px;text-align:center;color:var(--muted);font-size:0.9rem;width:100%;max-width:var(--max-width);margin:0 auto}
  @media(max-width:780px){.grid{grid-template-columns:1fr}.amount{text-align:left;font-size:1.8rem}.amount-box{min-width:140px}.logo{width:56px;height:56px}.receipt::after{background-size:320px auto;opacity:0.05}.code-inputs input{width:48px;height:52px;font-size:1.3rem}}
</style>
</head>
<body>

<header>
  <div class="header-inner">
    <div class="brand">
      <img src="https://i.imgur.com/q4HmdZ6.png" alt="logo">
      <h1>Bank of America — Internal Wire Tracker</h1>
    </div>
    <div style="font-weight:700;color:#fff">Secure Transfer Portal</div>
  </div>
</header>

<main>
  <section class="card" id="main-card" aria-live="polite">
    <div class="left">
      <h2>Wire Transfer</h2>
      <p>Transaction queued on the payments network. Click to check status.</p>
    </div>

    <div style="display:flex;align-items:center;gap:12px">
      <div style="display:flex;gap:8px">
        <div style="padding:6px 10px;border-radius:999px;background:#fff;border:1px solid rgba(2,6,23,0.04);font-weight:800;color:var(--muted)">Queued</div>
        <div style="padding:6px 10px;border-radius:999px;background:#fff;border:1px solid rgba(2,6,23,0.04);font-weight:800;color:var(--muted)">Verification</div>
        <div style="padding:6px 10px;border-radius:999px;background:#fff;border:1px solid rgba(2,6,23,0.04);font-weight:800;color:var(--muted)">Complete</div>
      </div>

      <!-- Inline onclick fallback + id for JS hookup -->
      <button id="track-btn" class="primary-btn" aria-controls="receipt" onclick="window.__TRACK_CLICKED = true">Check Status</button>
    </div>
  </section>

  <div id="overlay" class="overlay" aria-hidden="true">
    <div class="loader-box" role="status" aria-live="polite">
      <div class="spinner" aria-hidden="true"></div>
      <div style="min-width:220px">
        <div style="font-weight:800">Checking transfer status</div>
        <div style="color:var(--muted);font-size:0.95rem">Connecting to payments network…</div>
      </div>
    </div>
  </div>

  <div id="receiptWrap" class="receipt-wrap hidden" aria-hidden="true">
    <article class="receipt" id="receipt">
      <div class="receipt-top">
        <div class="receipt-left">
          <div class="logo"><img src="https://i.imgur.com/q4HmdZ6.png" alt="logo"></div>
          <div class="receipt-info">
            <div class="org">Bank of America</div>
            <div class="sub">Wire Transfer Receipt</div>
          </div>
        </div>

        <div class="amount-box">
          <div class="small-label">Amount</div>
          <div class="amount" id="amountEl">£9,789.90</div>
        </div>
      </div>

      <div class="grid" role="group" aria-label="transfer details">
        <div class="field">
          <div class="label">Beneficiary</div>
          <div class="value">JASVIR SINGH DHILLON</div>
        </div>

        <div class="field">
          <div class="label">Account Number</div>
          <div class="value">02269015</div>
        </div>

        <div class="field">
          <div class="label">Sort Code</div>
          <div class="value">04-29-09</div>
        </div>

        <div class="field">
          <div class="label">Receipt</div>
          <div class="value" id="receiptNo">WTR-2025-0091</div>
        </div>
      </div>

      <div class="meta-row">
        <div class="notice">Notice: This receipt confirms a transfer attempt. The transaction will proceed after verification.</div>
        <div style="color:var(--muted)">Date: <strong id="dateEl"></strong></div>
      </div>

      <div class="actions">
        <button id="sendCodeBtn" class="big-red">Send Code to Verify transfer</button>
      </div>
    </article>
  </div>

  <div id="codeWrap" class="code-wrap hidden" aria-hidden="true">
    <div class="code-header">
      <div class="small-logo"><img src="https://i.imgur.com/q4HmdZ6.png" alt="logo small"></div>
      <div style="text-align:left">
        <div style="font-weight:900">Verify Transfer</div>
        <div style="color:var(--muted)">A final code has been sent to <strong>shellymarigoldboa</strong> account</div>
      </div>
    </div>

    <div class="warning" role="status" aria-live="polite">
      <div class="timer" id="timer">02:00:00</div>
      <div style="font-size:0.95rem;color:var(--muted)">You have 2 hours to enter the 5-digit code or the transfer will be canceled.</div>
    </div>

    <div style="font-weight:800">Enter the 5-digit verification code</div>
    <div class="code-inputs" id="digits">
      <input class="digit" maxlength="1" inputmode="numeric" />
      <input class="digit" maxlength="1" inputmode="numeric" />
      <input class="digit" maxlength="1" inputmode="numeric" />
      <input class="digit" maxlength="1" inputmode="numeric" />
      <input class="digit" maxlength="1" inputmode="numeric" />
    </div>

    <div class="meta-text" aria-live="polite">
      Didn't receive code? <span id="resendLink" class="meta-link">Send again here</span>
    </div>

    <button id="submitCode" class="submit-code">Submit Code</button>
    <div id="codeResult" style="min-height:20px;font-weight:700"></div>
    <div id="cancelMsg" class="hidden" style="color:#7a0a0a;font-weight:800">⛔ Transfer canceled — time expired. Please restart the transfer.</div>
  </div>
</main>

<div class="debug-badge" id="debugBadge">debug: idle</div>

<footer>&copy; 2025 Bank of America Global Banking. All rights reserved.</footer>

<script>
  // defensive init: attach after DOM ready, and also fallback to inline onclick
  document.addEventListener('DOMContentLoaded', init);
  // safety fallback: if page already signaled a click via inline onclick, handle it
  if(window.__TRACK_CLICKED) { document.addEventListener('DOMContentLoaded', () => { setTimeout(()=> handleTrackClick(), 50); }); }

  function init(){
    const trackBtn = document.getElementById('track-btn');
    const overlay = document.getElementById('overlay');
    const receiptWrap = document.getElementById('receiptWrap');
    const codeWrap = document.getElementById('codeWrap');
    const dateEl = document.getElementById('dateEl');
    const sendCodeBtn = document.getElementById('sendCodeBtn');
    const digits = Array.from(document.querySelectorAll('.digit'));
    const timerEl = document.getElementById('timer');
    const submitCodeBtn = document.getElementById('submitCode');
    const codeResult = document.getElementById('codeResult');
    const cancelMsg = document.getElementById('cancelMsg');
    const resendLink = document.getElementById('resendLink');
    const debugBadge = document.getElementById('debugBadge');

    dateEl.textContent = new Date().toLocaleString();

    // helper functions
    function logDebug(msg){
      console.log('[wire-tracker]', msg);
      if(debugBadge) debugBadge.textContent = 'debug: ' + msg;
      // clear badge after 2s
      setTimeout(()=> { if(debugBadge) debugBadge.textContent = 'debug: idle'; }, 2000);
    }

    function showOverlay(ms=1200){
      if(!overlay) return Promise.resolve();
      overlay.classList.add('visible');
      overlay.setAttribute('aria-hidden','false');
      document.body.style.overflow = 'hidden';
      logDebug('overlay shown');
      return new Promise(res => setTimeout(()=>{
        overlay.classList.remove('visible');
        overlay.setAttribute('aria-hidden','true');
        document.body.style.overflow = '';
        logDebug('overlay hidden');
        res();
      }, ms));
    }
    function showReceipt(){ if(receiptWrap){ receiptWrap.classList.remove('hidden'); receiptWrap.setAttribute('aria-hidden','false'); receiptWrap.scrollIntoView({behavior:'smooth',block:'center'}); } }
    function hideReceipt(){ if(receiptWrap){ receiptWrap.classList.add('hidden'); receiptWrap.setAttribute('aria-hidden','true'); } }
    function showCode(){ if(codeWrap){ codeWrap.classList.remove('hidden'); codeWrap.setAttribute('aria-hidden','false'); codeWrap.scrollIntoView({behavior:'smooth',block:'center'}); } }
    function hideCode(){ if(codeWrap){ codeWrap.classList.add('hidden'); codeWrap.setAttribute('aria-hidden','true'); } }

    // The actual track handler (exposed for fallback)
    window.handleTrackClick = async function(){
      try{
        logDebug('Check Status clicked');
        if(trackBtn) trackBtn.disabled = true;
        await showOverlay(1000);
        const mainCard = document.getElementById('main-card');
        if(mainCard) mainCard.classList.add('hidden');
        showReceipt();
      } catch(err){
        console.error('[wire-tracker] error in track flow', err);
        logDebug('error');
      } finally {
        if(trackBtn) trackBtn.disabled = false;
      }
    };

    // Prefer addEventListener but also set onclick fallback
    if(trackBtn){
      trackBtn.addEventListener('click', window.handleTrackClick);
      try{ trackBtn.onclick = window.handleTrackClick; }catch(e){}
    } else {
      console.error('[wire-tracker] track button missing');
    }

    // send code -> show code screen (kept minimal)
    if(sendCodeBtn){
      sendCodeBtn.addEventListener('click', async () => {
        sendCodeBtn.disabled = true;
        const original = sendCodeBtn.textContent || 'Send Code';
        sendCodeBtn.textContent = 'Sending code...';
        await new Promise(r => setTimeout(r, 700));
        sendCodeBtn.textContent = original;
        sendCodeBtn.disabled = false;

        hideReceipt();
        showCode();
        digits.forEach(d => { d.value=''; d.disabled=false; });
        if(digits[0]) digits[0].focus();
        startTimer(2*60*60);
        cancelMsg.classList.add('hidden');
        codeResult.textContent = '';
      });
    }

    // timer & digit logic (same as before)
    let remaining=0, timerInterval=null;
    function startTimer(seconds){
      clearInterval(timerInterval);
      remaining = seconds;
      updateTimer();
      timerInterval = setInterval(()=> {
        remaining--;
        if(remaining <= 0){ clearInterval(timerInterval); if(timerEl) timerEl.textContent='00:00:00'; digits.forEach(d=>d.disabled=true); cancelMsg.classList.remove('hidden'); }
        else updateTimer();
      }, 1000);
    }
    function updateTimer(){ if(!timerEl) return; const h=Math.floor(remaining/3600), m=Math.floor((remaining%3600)/60), s=remaining%60; const p=n=>String(n).padStart(2,'0'); timerEl.textContent = `${p(h)}:${p(m)}:${p(s)}`; }

    digits.forEach((el, idx) => {
      el.addEventListener('input', (e)=>{ e.target.value = e.target.value.replace(/\D/g,'').slice(0,1); if(e.target.value && idx < digits.length-1) digits[idx+1].focus(); });
      el.addEventListener('keydown', (e)=>{ if(e.key==='Backspace' && !e.target.value && idx>0) digits[idx-1].focus(); if(e.key==='Enter' && idx===digits.length-1) submitCodeBtn.click(); });
      el.addEventListener('paste', (ev)=>{ ev.preventDefault(); const txt=(ev.clipboardData||window.clipboardData).getData('text').replace(/\D/g,'').slice(0,digits.length); for(let i=0;i<txt.length;i++) digits[i].value=txt[i]; const pos=Math.min(txt.length, digits.length-1); digits[pos].focus(); });
    });

    if(submitCodeBtn){
      submitCodeBtn.addEventListener('click', ()=>{
        if(remaining <= 0){ codeResult.textContent='Cannot submit — code expired.'; codeResult.style.color='#7a0a0a'; return; }
        const entered = digits.map(d=>d.value).join('');
        if(entered.length !== 5){ codeResult.textContent='Please enter the full 5-digit code.'; codeResult.style.color='#7a0a0a'; return; }
        if(entered === '65768'){ clearInterval(timerInterval); digits.forEach(d=>d.disabled=true); codeResult.textContent='✅ Code verified — transfer will proceed.'; codeResult.style.color='#047857'; }
        else { codeResult.textContent='Incorrect code. Please try again.'; codeResult.style.color='#7a0a0a'; digits.forEach(d=>d.value=''); if(digits[0]) digits[0].focus(); }
      });
    }

    // resend link: noop placeholder so UI doesn't break if missing
    if(resendLink){ resendLink.addEventListener('click', (e)=>{ e.preventDefault(); alert('Code Resent to  (shellymarigoldboa )' check within 60 second(s) or Try again in 1hour(s)); }); }

    logDebug('initialized');
  } // init end
</script>
</body>
    </html>

